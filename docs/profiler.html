<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/2000/REC-xhtml1-20000126/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Xdebug: Documentation Â» Profiling</title>
	<meta name="ROBOTS" content="ALL" />
	<meta name="MSSmartTagsPreventParsing" content="true" />
	<meta name="DESCRIPTION" content="Xdebug: A powerful debugger for PHP" />
	<meta name="AUTHOR" content="Derick Rethans, as in derick@xdebug.org" />
	<link rel="icon" type="image/png" href="../images/favicon.png">
		<link rel="stylesheet" type="text/css" href="../core2.css" />
	<meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
</head>
<body>
	<nav>
	<div class="content_width">
		<h1><a href="../index.html"><svg xmlns="http://www.w3.org/2000/svg" width="351" height="181" viewBox="0 0 351 181"><title>Xdebug</title><g fill="none" fill-rule="evenodd" stroke="#FFF"><g transform="translate(5 5)"><path fill="#317E1E" fill-rule="nonzero" stroke-width="5" d="M127.9 85.5l68.2 70.7.4 17.3h-38.6l-60.8-59.7-60 59.7h-39v-17.6l69.7-69.8-69.6-71.2V-2.5h38.7l60.2 60 61-60h38.3v16l-68.5 72z"/><circle cx="75.9" cy="74.6" r="3.5" stroke-opacity=".8" stroke-width="4"/><circle cx="105.1" cy="85" r="3.5" stroke-opacity=".8" stroke-width="4"/><circle cx="158.4" cy="15" r="3.5" stroke-opacity=".8" stroke-width="4"/><circle cx="50.9" cy="140" r="3.5" stroke-opacity=".8" stroke-width="4"/><circle cx="180.4" cy="158.5" r="3.5" stroke-opacity=".8" stroke-width="4"/><path stroke-linecap="square" stroke-linejoin="round" stroke-width="4" d="M32.6 158.2L42 149M104.3 69.1l49.4-49.4"/><path stroke-linejoin="round" stroke-width="4" d="M102.3 82.7L30.3 10H11.2M167.4 10H183M11.2 160.7l79.2-78"/><path stroke-linejoin="round" stroke-opacity=".7" stroke-width="4" d="M116.3 74.6L181 10"/><path stroke-linejoin="round" stroke-width="4" d="M20.7 19.7l52.7 52.6"/><path stroke-linejoin="round" stroke-opacity=".7" stroke-width="4" d="M116.3 96.7l32 32"/><path stroke-linejoin="round" stroke-width="4" d="M155.2 133.6l22.1 22M53.6 137.5L97 94.9l67.1 66.6h4.9"/></g><g fill="#000" fill-rule="nonzero" stroke-width="4"><path d="M158.3 107.7V72.9c0-.5 0-.5-.8-.5-.7 0-.7 0-.7.6v34.7c0 .6 0 .5.7.5.8 0 .7 0 .7-.5zm3.9 11.2a22.5 22.5 0 0 1-20-.7c-3.4-2-5.2-4.8-5.2-8.4V69.6c0-3 1.5-5.6 4.3-7.4a17 17 0 0 1 9.2-2.4c3 0 5.6.3 7.7 1V47H178v73h-15l-.8-1.1zM200.9 84V73.2c0-.8 0-.8-.8-.8s-.8 0-.8.8V84h1.6zm-1.6 12.5v11c0 .7 0 .7.8.7.7 0 .8 0 .8-.8V97.2h19.8v10.4c0 8.9-7.3 13.2-20.7 13.2-13.3 0-20.5-4.5-20.5-13.7V73.6c0-9.2 7.2-13.8 20.5-13.8 13.4 0 20.7 4.4 20.7 13.4v23.3h-21.4zM243.3 107.7V73c0-.6 0-.6-.7-.6-.8 0-.8 0-.8.5v34.8c0 .6 0 .5.8.5.7 0 .7 0 .7-.5zm-5.4 11.1l-.9 1.3h-15V47h19.8v13.8c2.1-.7 4.7-1 7.9-1 3.1 0 6.1.8 8.8 2.3 3 1.6 4.6 4.2 4.6 7.5v40.2c0 3.6-1.8 6.4-5.3 8.4a22.5 22.5 0 0 1-19.9.6zM285.8 119.7c-2.1.8-4.7 1.1-7.8 1.1a17 17 0 0 1-9.1-2.4c-2.8-1.7-4.4-4.2-4.4-7.2v-51h19.8v47.5c0 .6 0 .5.8.5.7 0 .7 0 .7-.4V60h19.8v60h-19.8v-.4zM328.3 108.3V73c0-.6 0-.6-.7-.6-.8 0-.8 0-.8.6V108c0 .6 0 .6.8.6.7 0 .7 0 .7-.4zm-.9 11.8c-2 .5-4.2.7-6.9.7a17 17 0 0 1-9.1-2.4c-2.9-1.7-4.4-4.2-4.4-7.2V71c0-7.4 5.2-11.2 14.6-11.2 2.3 0 5 .7 8.3 2l1.7-1.7H348v57.3c0 4.4-1 9.5-2.8 12-2.1 3.2-7.7 4.5-17 4.5h-18.4v-12h14.9c1.1 0 2-.7 2.7-1.8z"/></g></g></svg>
</a></h1>
		<ul id="menu">
			<li><a href="install.html">Install</a></li>
			<li><a href="index.html">Documentation</a></li>
			<li><a href="../reporting-bugs.html">Report Issues</a></li>
			<li><a href="https://github.com/xdebug/xdebug" target="_blank">GitHub</a></li>
		</ul>
	</div>
</nav>
<div class="deprecated">
You're visiting the archived website and documentation of Xdebug 2, which is no longer supported. This website is temporarily available and will be discontinued on Dec 31st, 2021.
</div>

	<div class="content_width" id="support">If you find Xdebug useful, please consider <a href='../support.html'>supporting the project</a>.</div>

	<main class="content_width">
<h1>Profiling</h1>

<div class="doc_section">
	<p class='intro'>Xdebug's built-in profiler allows you to find bottlenecks in your
			script and visualize those with an external tool such as KCacheGrind or
			WinCacheGrind.</p>
	<a name="introduction"></a>
<h2>Introduction</h2>

<p>Xdebug's Profiler is a powerful tool that gives you the ability to analyse
your PHP code and determine bottlenecks or generally see which parts of your
code are slow and could use a speed boost. Since Xdebug 2.6, the profiler also
collects information about how much memory is being used, and which functions
and methods increase memory usage.</p>

<p>The profiler in Xdebug outputs
profiling information in the form of a Cachegrind compatible file.  This allows
you to use the excellent <a href="https://kcachegrind.github.io">KCacheGrind</a>
tool (Linux, KDE) to analyse your profiling data. If you are on Linux
you can install KCacheGrind with your favourite package manager.</p>

<p>If you are on Windows, there are precompiled <a
href="http://sourceforge.net/projects/qcachegrindwin/">QCacheGrind</a>
binaries available. (QCacheGrind is KCacheGrind without KDE bindings).</p>

<p>If you are on Mac OSX, there are <a
href="http://www.tekkie.ro/computer-setup/how-to-install-kcachegrind-qcachegrind-on-mac-osx/">instructions</a>
on how to build QCacheGrind too.</p>

<p>Users of Windows can alternatively use
<a href="http://ceefour.github.io/wincachegrind/">WinCacheGrind</a>. The
functionality is different from KCacheGrind so the section that documents the
use of KCacheGrind on this page doesn't apply to this program. WinCacheGrind
currently does not support the file and function compression for cachegrind
files that Xdebug 2.3 introduces yet.</p>

<p>There is also
an alternative profile information presentation tool called
<a href="https://github.com/alexeykupershtokh/xdebugtoolkit">xdebugtoolkit</a>, a web
based front-end called <a
href="https://github.com/jokkedk/webgrind">Webgrind</a>, and a Java based tool
called <a
href="http://sourceforge.net/projects/xcallgraph/">XCallGraph</a>.</p>

<p>In case you can not use KDE (or do not want to use KDE) the kcachegrind
package also comes with a perl script "ct_annotate" which produces ASCII output
from the profiler trace files.</p>

<a name="starting"></a>
<h2>Starting The Profiler</h2>

<p>Profiling is enabled by setting the
<a href="all_settings.html#profiler_enable">xdebug.profiler_enable</a> setting
to 1 in php.ini. This instructs Xdebug to start writing profiling information
into the dump directory configured with the
<a href="all_settings.html#profiler_output_dir">xdebug.profiler_output_dir</a>
directive. The name of the generated file always starts with
"<span class="filename">cachegrind.out.</span>" and ends with either the PID
(process ID) of the PHP (or Apache) process or the crc32 hash of the
directory containing the initially debugged script. Make sure you have enough
space in your <a href="all_settings.html#profiler_output_dir">xdebug.profiler_output_dir</a> as the amount of information generated by the profiler can be
enormous for complex scripts, for example up to 500MB for a complex application
like <a href="http://ez.no">eZ Publish</a>.</p>

<p>You can also selectively enable the profiler with the
<a href="all_settings.html#profiler_enable_trigger">xdebug.profiler_enable_trigger</a> setting set to 1. If it is set to 1, then you can
enable the profiler by using a GET/POST or COOKIE variable of the name
XDEBUG_PROFILE. The FireFox 2 extension that can be used to enable the debugger
(see <a href="remote.html#firefox-ext">HTTP Debug Sessions</a>) can also be
used with this setting. In order for the trigger to work properly,
<a href="all_settings.html#profiler_enable">xdebug.profiler_enable</a> needs to be set to 0.</p>

<p>From Xdebug 2.6 onwards, Xdebug adds the HTTP header
<code>X-Xdebug-Profile-Filename</code> to a request that is being profiled.
This header contains the name of the file that holds the profiling information
for that request.</p>

<a name="misc"></a>
<a name="kcachegrind"></a>
<h2>Analysing Profiles</h2>

<p>After a profile information file has been generated you can open it with
<a href="https://kcachegrind.github.io">KCacheGrind</a>:</p>

<p><img src="../images/docs/kc-open.png"/></p>

<p>Once the file is opened you have plenty of information available in the
different panes of <a href="https://kcachegrind.github.io">KCacheGrind</a>. On the left side you find the "Flat Profile"
pane showing all functions in your script sorted by time spent in this function,
and all its children.
<img class="l" src="../images/docs/kc-profile.png" align="left"/>
The second column "Self" shows the time spent in this function (without its
children), the third column "Called" shows how often a specific function was
called and the last column "Function" shows the name of the function. Xdebug
changes internal PHP function names by prefixing the function name with
"php::" and include files are handled in a special way too. Calls to include
(and include_once, require and require_once) are followed by "::" and the
filename of the included file. In the screenshot on the left you can see this
for "include::/home/httpd/ez_34/v..." and an example of an internal PHP
function is "php::mysql_query".
<img class="r" src="../images/docs/kc-percentage.png" align="right"/>
The numbers in the first two columns can be
either percentages of the full running time of the script (like in the
example) or absolute time (1 unit is 1/1.000.000th of a second). You can
switch between the two modes with the button you see on the right.</p>

<p>The pane on the right contains an upper and lower pane. The upper one
shows information about which functions called the current selected function
("eztemplatedesignresource-&gt;executecompiledtemplate in the screenshot).
<img class="r" src="../images/docs/kc-right-call.png" align="right"/>
The lower pane shows information about the functions that the current selected
function called.</p>

<p>The "Cost" column in the upper pane shows the time spent in the current
selected function while being called from the function in the list. The numbers
in the Cost column added up will always be 100%. The "Cost" column in the lower
pane shows the time spent while calling the function from the list. While adding
the numbers in this list up, you will most likely never reach 100% as the
selected function itself will also takes time to execute.</p>

<p>The "All Callers" and "All Calls" tabs show not only the direct calls from
<img class="l" src="../images/docs/kc-right-callers.png" align="left"/>
which the function was called respectively all directly made
function calls but also function calls made more levels up and down.
The upper pane in the screenshot on the left shows all functions calling the
current selected one, both directly and indirectly with other functions
inbetween them on the stack. The "Distance" column shows how many function
calls are between the listed and the current selected one (-1). If there are
different distances between two functions, it is shown as a range (for example
"5-24"). The number in parentheses is the median distance. The lower pane is
similar except that it shows information on functions called from the current
selected one, again either direct or indirect.</p>

			<h2>Related Settings and Functions</h2>
		<ul>
							<li><span class='type'>integer</span> <a href='profiler.html#profiler_aggregate'>xdebug.profiler_aggregate</a> = <span class='default'>0</span></li>
							<li><span class='type'>integer</span> <a href='profiler.html#profiler_append'>xdebug.profiler_append</a> = <span class='default'>0</span></li>
							<li><span class='type'>integer</span> <a href='profiler.html#profiler_enable'>xdebug.profiler_enable</a> = <span class='default'>0</span></li>
							<li><span class='type'>integer</span> <a href='profiler.html#profiler_enable_trigger'>xdebug.profiler_enable_trigger</a> = <span class='default'>0</span></li>
							<li><span class='type'>string</span> <a href='profiler.html#profiler_enable_trigger_value'>xdebug.profiler_enable_trigger_value</a> = <span class='default'>""</span></li>
							<li><span class='type'>string</span> <a href='profiler.html#profiler_output_dir'>xdebug.profiler_output_dir</a> = <span class='default'>/tmp</span></li>
							<li><span class='type'>string</span> <a href='profiler.html#profiler_output_name'>xdebug.profiler_output_name</a> = <span class='default'>cachegrind.out.%p</span></li>
					</ul>
		<ul>
							<li><a href='profiler.html#xdebug_get_profiler_filename'><span class='name'>xdebug_get_profiler_filename</span></a>()<span class='type'> : mixed</span></li>
					</ul>
	
	<a name='settings'></a>
			<div class='settings'>
			<h3>Settings</h3>

							<hr>
				<div class="doc_setting">
	<a name='profiler_aggregate'></a>
	<a name='xdebug.profiler_aggregate'></a>
	<h4><span class='type'>integer</span> xdebug.profiler_aggregate = <span class='default'>0</span> <a href='profiler.html#profiler_aggregate'>#</a></h4>

		<p>Available in <span class='type'>Xdebug < 2.9</span></p>
	<div class='description'><p>When this setting is set to 1, a single profiler file will be written
for multiple requests. One can surf to multiple pages or reload a page
to get an <strong>average</strong> across all requests. The file will be named
<code>.cachegrind.aggregate</code>. You will need to move this file to get
another round of aggregate data.</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_append'></a>
	<a name='xdebug.profiler_append'></a>
	<h4><span class='type'>integer</span> xdebug.profiler_append = <span class='default'>0</span> <a href='profiler.html#profiler_append'>#</a></h4>

		
	<div class='description'><p>When this setting is set to 1, profiler files will not be overwritten when
a new request would map to the same file (depending on the <a href="all_settings.html#profiler_output_name">xdebug.profiler_output_name</a> setting.
Instead the file will be appended to with the new profile.</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_enable'></a>
	<a name='xdebug.profiler_enable'></a>
	<h4><span class='type'>integer</span> xdebug.profiler_enable = <span class='default'>0</span> <a href='profiler.html#profiler_enable'>#</a></h4>

		
	<div class='description'><p>Enables Xdebug's profiler which creates files in the
<a href="all_settings.html#profiler_output_dir">profile output directory</a>.  Those files can be
read by KCacheGrind to visualize your data.  This setting can not be set in
your script with ini_set(). If you want to selectively enable the profiler,
please set <a href="all_settings.html#profiler_enable_trigger">xdebug.profiler_enable_trigger</a> to 1 <strong>instead</strong> of using
this setting.</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_enable_trigger'></a>
	<a name='xdebug.profiler_enable_trigger'></a>
	<h4><span class='type'>integer</span> xdebug.profiler_enable_trigger = <span class='default'>0</span> <a href='profiler.html#profiler_enable_trigger'>#</a></h4>

		
	<div class='description'><p>When this setting is set to 1, you can trigger the generation of profiler
files by using the XDEBUG_PROFILE GET/POST parameter, or set a cookie with the
name XDEBUG_PROFILE. This will then write the profiler data to
<a href="all_settings.html#profiler_output_dir">defined directory</a>. In order to prevent the profiler
to generate profile files for each request, you need to set
<a href="all_settings.html#profiler_enable">xdebug.profiler_enable</a> to 0. Access to the trigger itself can be configured
through <a href="all_settings.html#profiler_enable_trigger_value">xdebug.profiler_enable_trigger_value</a>.</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_enable_trigger_value'></a>
	<a name='xdebug.profiler_enable_trigger_value'></a>
	<h4><span class='type'>string</span> xdebug.profiler_enable_trigger_value = <span class='default'>""</span> <a href='profiler.html#profiler_enable_trigger_value'>#</a></h4>

	<p>Introduced in <span class='type'>Xdebug >= 2.3</span></p>	
	<div class='description'><p>This setting can be used to restrict who can make use of the
XDEBUG_PROFILE functionality as outlined in <a href="all_settings.html#profiler_enable_trigger">xdebug.profiler_enable_trigger</a>. When
changed from its default value of an empty string, the value of the cookie,
GET or POST argument needs to match the shared secret set with this setting in order
for the profiler to start.</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_output_dir'></a>
	<a name='xdebug.profiler_output_dir'></a>
	<h4><span class='type'>string</span> xdebug.profiler_output_dir = <span class='default'>/tmp</span> <a href='profiler.html#profiler_output_dir'>#</a></h4>

		
	<div class='description'><p>The directory where the profiler output will be written to, make sure that
the user who the PHP will be running as has write permissions to that
directory. This setting can not be set in your script with ini_set().</p>
</div>
</div>
							<hr>
				<div class="doc_setting">
	<a name='profiler_output_name'></a>
	<a name='xdebug.profiler_output_name'></a>
	<h4><span class='type'>string</span> xdebug.profiler_output_name = <span class='default'>cachegrind.out.%p</span> <a href='profiler.html#profiler_output_name'>#</a></h4>

		
	<div class='description'><p>This setting determines the name of the file that is used to dump
traces into. The setting specifies the format with format specifiers, very
similar to sprintf() and strftime(). There are several format specifiers
that can be used to format the file name.</p>

<p>See the <a href="all_settings.html#trace_output_name">xdebug.trace_output_name</a> documentation for the supported
specifiers.</p>
</div>
</div>
					</div>
	
	<a name='functions'></a>
			<div class='functions'>
			<h3>Functions</h3>

							<hr>
				<div class="doc_function">
	<a name='xdebug_get_profiler_filename'></a>
	<h3 class="name">
					xdebug_get_profiler_filename()
				<span class='type'> : mixed</span>
		<a href='profiler.html#xdebug_get_profiler_filename'>#</a>
	</h3>

	<div class='short-description'><p>Returns the profile information filename</p></div>

	
	<div class='description'><p>
Returns the name of the file which is used to save profile information to, or
 <code>false</code> if the profiler is not active.

</p></div>
</div>
					</div>
	</div>


</main>


	<footer class="content_width">
		<p>
		This site and all of its contents are Copyright &copy; 2002-2020 by Derick Rethans.<br />
		All rights reserved.
		</p>
	</footer>
</body>
</html>
